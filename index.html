<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="user-scalable=no">
        <link rel="icon" href="icon/icon.png" type="image/png">
        <link rel="apple-touch-icon" href="icon/icon.png">
        <link rel="stylesheet" type="text/css" href="fonts/gamefont.css">
        <title>祥澄RPG大冒險</title>
        <style>
            #escButton {
                position: fixed;
                bottom: 20px;
                right: 20px;
                width: 60px;
                height: 60px;
                background-color: rgba(0, 0, 0, 0.8);  /* 調深顏色 */
                color: white;
                border: 2px solid white;  /* 添加邊框 */
                border-radius: 50%;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                z-index: 99999;  /* 提高層級 */
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
                display: block !important;  /* 強制顯示 */
                pointer-events: auto !important;  /* 確保可點擊 */
            }

            #escButton:active {
                background-color: rgba(50, 50, 50, 0.9);
                transform: scale(0.95);
            }
        </style>
    </head>
    <body style="background-color: black">
        <!-- 將按鈕移到最後，確保它在其他元素之上 -->
        <script type="text/javascript" src="js/libs/pixi.js"></script>
        <script type="text/javascript" src="js/libs/pixi-tilemap.js"></script>
        <script type="text/javascript" src="js/libs/pixi-picture.js"></script>
        <script type="text/javascript" src="js/libs/fpsmeter.js"></script>
        <script type="text/javascript" src="js/libs/lz-string.js"></script>
        <script type="text/javascript" src="js/libs/iphone-inline-video.browser.js"></script>
        <script type="text/javascript" src="js/rpg_core.js"></script>
        <script type="text/javascript" src="js/rpg_managers.js"></script>
        <script type="text/javascript" src="js/rpg_objects.js"></script>
        <script type="text/javascript" src="js/rpg_scenes.js"></script>
        <script type="text/javascript" src="js/rpg_sprites.js"></script>
        <script type="text/javascript" src="js/rpg_windows.js"></script>
        <script type="text/javascript" src="js/plugins.js"></script>
        <script type="text/javascript" src="js/main.js"></script>
        
        <!-- 移動到這裡 -->
        <button id="escButton">ESC</button>

        <script>
            // 確保 DOM 完全加載後再添加事件監聽
            window.addEventListener('DOMContentLoaded', (event) => {
                const escButton = document.getElementById('escButton');
                if (escButton) {  // 檢查按鈕是否存在
                    escButton.addEventListener('click', function() {
                        console.log('ESC button clicked');  // 添加調試日誌
                        const escEvent = new KeyboardEvent('keydown', {
                            key: 'Escape',
                            code: 'Escape',
                            keyCode: 27,
                            which: 27,
                            bubbles: true,
                            cancelable: true
                        });
                        document.dispatchEvent(escEvent);
                    });
                }
            });

            // 確保按鈕在遊戲加載後仍然可見
            window.addEventListener('load', (event) => {
                const escButton = document.getElementById('escButton');
                if (escButton) {
                    escButton.style.display = 'block';
                    escButton.style.zIndex = '99999';
                }
            });
        </script>
    </body>
</html>