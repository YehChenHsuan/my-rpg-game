<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="user-scalable=no">
        <link rel="icon" href="icon/icon.png" type="image/png">
        <link rel="apple-touch-icon" href="icon/icon.png">
        <link rel="stylesheet" type="text/css" href="fonts/gamefont.css">
        <title>祥澄RPG大冒險</title>
        <style>
            #gameCanvas {
                position: relative;
                width: 100%;
                height: 100vh;
                overflow: hidden;
            }
            
            #escButton {
                position: absolute;
                bottom: 20px;
                right: 20px;
                width: 60px;
                height: 60px;
                background-color: rgba(0, 0, 0, 0.8);
                color: white;
                border: 2px solid white;
                border-radius: 50%;
                font-size: 16px;
                font-weight: bold;
                cursor: pointer;
                z-index: 99999;
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
                display: block !important;
                pointer-events: auto !important;
            }

            #escButton:active {
                background-color: rgba(50, 50, 50, 0.9);
                transform: scale(0.95);
            }
        </style>
    </head>
    <body style="background-color: black">
        <div id="gameCanvas">
            <script type="text/javascript" src="js/libs/pixi.js"></script>
            <script type="text/javascript" src="js/libs/pixi-tilemap.js"></script>
            <script type="text/javascript" src="js/libs/pixi-picture.js"></script>
            <script type="text/javascript" src="js/libs/fpsmeter.js"></script>
            <script type="text/javascript" src="js/libs/lz-string.js"></script>
            <script type="text/javascript" src="js/libs/iphone-inline-video.browser.js"></script>
            <script type="text/javascript" src="js/rpg_core.js"></script>
            <script type="text/javascript" src="js/rpg_managers.js"></script>
            <script type="text/javascript" src="js/rpg_objects.js"></script>
            <script type="text/javascript" src="js/rpg_scenes.js"></script>
            <script type="text/javascript" src="js/rpg_sprites.js"></script>
            <script type="text/javascript" src="js/rpg_windows.js"></script>
            <script type="text/javascript" src="js/plugins.js"></script>
            <script type="text/javascript" src="js/main.js"></script>
            
            <button id="escButton">ESC</button>
        </div>

        <script>
            window.addEventListener('DOMContentLoaded', (event) => {
                const escButton = document.getElementById('escButton');
                if (escButton) {
                    escButton.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                        
                        const keydownEvent = new KeyboardEvent('keydown', {
                            key: 'Escape',
                            code: 'Escape',
                            keyCode: 27,
                            which: 27,
                            bubbles: true,
                            cancelable: true
                        });
                        
                        const keyupEvent = new KeyboardEvent('keyup', {
                            key: 'Escape',
                            code: 'Escape',
                            keyCode: 27,
                            which: 27,
                            bubbles: true,
                            cancelable: true
                        });

                        document.dispatchEvent(keydownEvent);
                        setTimeout(() => {
                            document.dispatchEvent(keyupEvent);
                        }, 100);
                    });

                    escButton.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        const keydownEvent = new KeyboardEvent('keydown', {
                            key: 'Escape',
                            code: 'Escape',
                            keyCode: 27,
                            which: 27,
                            bubbles: true,
                            cancelable: true
                        });
                        
                        const keyupEvent = new KeyboardEvent('keyup', {
                            key: 'Escape',
                            code: 'Escape',
                            keyCode: 27,
                            which: 27,
                            bubbles: true,
                            cancelable: true
                        });

                        document.dispatchEvent(keydownEvent);
                        setTimeout(() => {
                            document.dispatchEvent(keyupEvent);
                        }, 100);
                    });
                }
            });

            window.addEventListener('load', (event) => {
                const escButton = document.getElementById('escButton');
                if (escButton) {
                    escButton.style.display = 'block';
                    escButton.style.zIndex = '99999';
                }
            });
        </script>
    </body>
</html>